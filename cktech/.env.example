# Shade Production Configuration - CKTech.org
# Copy this to .env and update all values
# NEVER commit .env to git!

# ============================================================================
# Core Settings - CKTech.org Deployment
# ============================================================================

RUST_LOG=shade=info,tower_http=info

# Container binding
SHADE_HOST=0.0.0.0
SHADE_PORT=8083

# Public domain (nginx reverse proxy)
SHADE_ISSUER=https://auth.cktech.org
SHADE_EXTERNAL_URL=https://auth.cktech.org

# ============================================================================
# Security - GENERATE SECURE SECRETS!
# ============================================================================

# Generate with: openssl rand -base64 64
SHADE_COOKIE_SECRET=base64:REPLACE_WITH_SECURE_SECRET

# JWT settings
SHADE_JWT_SIGNING_ALG=RS256
SHADE_ACCESS_TOKEN_TTL=3600
SHADE_REFRESH_TOKEN_TTL=2592000

# Security features
SHADE_REQUIRE_PKCE=true
SHADE_REFRESH_TOKEN_ROTATION=true
SHADE_MAX_FAILED_ATTEMPTS=5
SHADE_LOCKOUT_DURATION_MINUTES=15

# ============================================================================
# Database - PostgreSQL
# ============================================================================

# Generate password: openssl rand -base64 32
DATABASE_URL=postgres://shade:STRONG_DB_PASSWORD@db:5432/shade
DATABASE_MAX_CONNECTIONS=20

POSTGRES_DB=shade
POSTGRES_USER=shade
POSTGRES_PASSWORD=STRONG_DB_PASSWORD

# ============================================================================
# Redis - Session Store
# ============================================================================

# Generate password: openssl rand -base64 32
REDIS_URL=redis://:STRONG_REDIS_PASSWORD@redis:6379
REDIS_PASSWORD=STRONG_REDIS_PASSWORD

# ============================================================================
# Admin Bootstrap
# ============================================================================

SHADE_ADMIN_EMAIL=admin@cktech.org
SHADE_ADMIN_PASSWORD=CHANGE_ME_IMMEDIATELY

# ============================================================================
# OAuth Providers - CKTech.org Production URLs
# ============================================================================

# Google OAuth (for Claude Max subscription)
# Redirect URI: https://auth.cktech.org/callback/google
OIDC_GOOGLE_CLIENT_ID=your_google_client_id.apps.googleusercontent.com
OIDC_GOOGLE_CLIENT_SECRET=your_google_client_secret
OIDC_GOOGLE_REDIRECT_URI=https://auth.cktech.org/callback/google

# GitHub OAuth (for Copilot Pro subscription)
# Callback URL: https://auth.cktech.org/callback/github
OIDC_GITHUB_CLIENT_ID=your_github_client_id
OIDC_GITHUB_CLIENT_SECRET=your_github_client_secret
OIDC_GITHUB_REDIRECT_URI=https://auth.cktech.org/callback/github

# Microsoft Entra ID (M365 SSO)
# Redirect URI: https://auth.cktech.org/callback/entra
OIDC_ENTRA_TENANT_ID=your_tenant_id
OIDC_ENTRA_CLIENT_ID=your_entra_client_id
OIDC_ENTRA_CLIENT_SECRET=your_entra_client_secret
OIDC_ENTRA_REDIRECT_URI=https://auth.cktech.org/callback/entra

# ============================================================================
# Deployment Checklist
# ============================================================================
#
# [ ] Generate SHADE_COOKIE_SECRET: openssl rand -base64 64
# [ ] Generate POSTGRES_PASSWORD: openssl rand -base64 32
# [ ] Generate REDIS_PASSWORD: openssl rand -base64 32
# [ ] Update DATABASE_URL with password
# [ ] Update REDIS_URL with password
# [ ] Set strong SHADE_ADMIN_PASSWORD
# [ ] Configure OAuth apps with auth.cktech.org URLs
# [ ] Copy this to .env (not .env.example)
# [ ] Test: docker compose up -d --build
# [ ] Configure nginx: cp nginx-shade.conf /etc/nginx/sites-available/shade
# [ ] Test nginx: sudo nginx -t
# [ ] Reload nginx: sudo systemctl reload nginx
#
# ============================================================================
